#' @title Cria tabela com autores de documentos com seus respectivos tipos de documentos
#' @description Retorna um dataframe contendo informações com os autores dos documentos e seus tipos
#' @param docs_ids_df Dataframe com os ids dos documentos e de autores
#' @return Dataframe
#' @export
create_tabela_atores <- function(documentos_df, autores_df) {
  
  if ((is.null(documentos_df) | is.null(autores_df)) |
      ((nrow(documentos_df) == 0) | (nrow(autores_df) == 0))) {
    warning("Dataframes de entrada devem ser não-nulos e não-vazios.")
    return(tibble::tibble())
  }
  
  autores_docs <- merge(documentos_df, autores_df, by = c("id_documento", "casa")) %>%
    dplyr::select(id_principal,
                  casa,
                  id_documento,
                  id_autor,
                  nome_autor = nome,
                  codTipo,
                  sigla_tipo,
                  descricao_tipo = descricaoTipo,
                  sigla_orgao = statusProposicao.siglaOrgao)

  atores_df <- autores_docs %>%
    dplyr::group_by(id_principal,
                    casa,
                    id_autor,
                    nome_autor,
                    codTipo,
                    sigla_tipo,
                    descricao_tipo,
                    sigla_orgao) %>%
    dplyr::summarise(qtd_de_documentos = dplyr::n()) %>%
    dplyr::arrange(id_principal, -qtd_de_documentos)

  return(atores_df)
}
